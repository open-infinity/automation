#!/bin/bash
linesToAddString="<%= etc_hosts_additions %>"
echo linesToAddString is: $linesToAddString
IFS=',' read -a linesToAdd <<< "$linesToAddString"
echo now adding: $linesToAdd
for i in "${linesToAdd[@]}"
do
   :
   echo processing line
   # check if line already exists
   alreadyExists='false'
   lineToAdd=$i;
   filename="/etc/hosts"
   while read -r lineInFile
   do
     echo "Name read from file: $lineInFile , linetoadd: $lineToAdd"
     if [ "$lineInFile" == "$lineToAdd" ];
        then
        alreadyExists='true'
     fi
     done < "$filename"
     falseValue='false'
     if [ "$alreadyExists" == "$falseValue" ];
     then
        echo now printing line $lineToAdd to file /etc/hosts
        printf "$lineToAdd" >> /etc/hosts
        printf "\n" >> /etc/hosts
     fi
done
